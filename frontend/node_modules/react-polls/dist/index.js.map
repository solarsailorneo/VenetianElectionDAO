{"version":3,"file":"index.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/index.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport animate from 'animate.css'\n\nimport styles from './styles.css'\n\nconst themes = {\n  purple: ['#6D4B94', '#7C6497', '#6D4B943B'],\n  red: ['#E23D3D', '#EF4545', '#FF28283B'],\n  blue: ['#5674E0', '#5674E0', '#5674E03B'],\n  black: ['#303030', '#303030', '#3030303B'],\n  white: ['#ffffff', '#ffffff', '#ffffff3B'],\n  cyan: ['#00BCDD', '#00BCDD', '#00BCDD3B']\n}\n\nexport default class Poll extends Component {\n  // Answers prop format: [ { option: string, votes: number } ]\n  static propTypes = {\n    question: PropTypes.string.isRequired,\n    answers: PropTypes.array.isRequired,\n    onVote: PropTypes.func.isRequired,\n    customStyles: PropTypes.object,\n    noStorage: PropTypes.bool,\n    vote: PropTypes.string\n  }\n\n  static defaultProps = {\n    customStyles: {\n      questionSeparator: true,\n      questionSeparatorWidth: 'question',\n      questionBold: true,\n      questionColor: '#303030',\n      align: 'center',\n      theme: 'black'\n    },\n    noStorage: false\n  }\n\n  state = {\n    poll: {\n      voted: false,\n      option: ''\n    },\n    totalVotes: 0\n  }\n\n  componentDidMount() {\n    const { noStorage } = this.props\n    if (!noStorage) this.checkVote()\n    this.loadVotes()\n  }\n\n  componentWillReceiveProps() {\n    this.loadVotes()\n  }\n\n  checkVote = () => {\n    const { question } = this.props\n    const storage = this.getStoragePolls()\n    const answer = storage.filter(answer => answer.question === question && answer.url === location.href)\n\n    if (answer.length) {\n      this.setPollVote(answer[0].option)\n    }\n  }\n\n  loadVotes = () => {\n    const { answers, vote } = this.props\n    const totalVotes = answers.reduce((total, answer) => total + answer.votes, 0)\n    this.setState({\n      totalVotes: answers.reduce((total, answer) => total + answer.votes, 0)\n    })\n    if (vote) this.setPollVote(vote)\n  }\n\n  setPollVote = (answer) => {\n    const { answers, vote } = this.props\n    const optionsOnly = answers.map(item => item.option)\n\n    if (optionsOnly.includes(answer)) {\n      const { poll, totalVotes } = this.state\n      const newPoll = { ...poll }\n      newPoll.voted = true\n      newPoll.option = answer\n\n      if (!vote) {\n        this.setState({\n          poll: newPoll,\n          totalVotes: totalVotes + 1\n        })\n      } else {\n        this.setState({\n          poll: newPoll\n        })\n      }\n    }\n  }\n\n  // Storage format: [ { url: string, question: string, option: string } ]\n  getStoragePolls = () => JSON.parse(localStorage.getItem('react-polls')) || []\n\n  vote = answer => {\n    const { question, onVote, noStorage } = this.props\n    if (!noStorage) {\n      const storage = this.getStoragePolls()\n      storage.push({\n        url: location.href,\n        question: question,\n        option: answer\n      })\n      localStorage.setItem('react-polls', JSON.stringify(storage))\n    }\n\n    this.setPollVote(answer)\n    onVote(answer)\n  }\n\n  calculatePercent = (votes, total) => {\n    if (votes === 0 && total === 0) {\n      return '0%'\n    }\n    return `${parseInt((votes / total) * 100)}%`\n  }\n\n  alignPoll = (customAlign) => {\n    if (customAlign === 'left') {\n      return 'flex-start'\n    } else if (customAlign === 'right') {\n      return 'flex-end'\n    } else {\n      return 'center'\n    }\n  }\n\n  obtainColors = customTheme => {\n    const colors = themes[customTheme]\n    if (!colors) {\n      return themes['black']\n    }\n    return colors\n  }\n\n  render() {\n    const { question, answers, customStyles } = this.props\n    const { poll, totalVotes } = this.state\n    const colors = this.obtainColors(customStyles.theme)\n\n    return (\n      <article className={`${animate.animated} ${animate.fadeIn} ${animate.faster} ${styles.poll}`} style={{ textAlign: customStyles.align, alignItems: this.alignPoll(customStyles.align) }}>\n        <h3 className={styles.question} style={{ borderWidth: customStyles.questionSeparator ? '1px' : '0', alignSelf: customStyles.questionSeparatorWidth === 'question' ? 'center' : 'stretch', fontWeight: customStyles.questionBold ? 'bold' : 'normal', color: customStyles.questionColor }}>{question}</h3>\n        <ul className={styles.answers}>\n          {answers.map(answer => (\n            <li key={answer.option}>\n              {!poll.voted ? (\n                <button className={`${animate.animated} ${animate.fadeIn} ${animate.faster} ${styles.option} ${styles[customStyles.theme]}`} style={{ color: colors[0], borderColor: colors[1] }} type='button' onClick={() => this.vote(answer.option)}>\n                  {answer.option}\n                </button>\n              ) : (\n                <div className={`${animate.animated} ${animate.fadeIn} ${animate.faster} ${styles.result}`} style={{ color: colors[0], borderColor: colors[1] }}>\n                  <div className={styles.fill} style={{ width: this.calculatePercent(answer.votes, totalVotes), backgroundColor: colors[2] }} />\n                  <div className={styles.labels}>\n                    <span className={styles.percent} style={{ color: colors[0] }}>{this.calculatePercent(answer.votes, totalVotes)}</span>\n                    <span className={`${styles.answer} ${answer.option === poll.option ? styles.vote : ''}`} style={{ color: colors[0] }}>{answer.option}</span>\n                  </div>\n                </div>\n              )}\n            </li>\n          ))}\n        </ul>\n        <p className={styles.votes}>{`${totalVotes} vote${totalVotes !== 1 ? 's' : ''}`}</p>\n      </article>\n    )\n  }\n}\n"],"names":["themes","Poll","state","checkVote","question","props","storage","getStoragePolls","answer","filter","url","location","href","length","setPollVote","option","loadVotes","answers","vote","totalVotes","reduce","total","votes","setState","optionsOnly","map","item","includes","poll","newPoll","voted","JSON","parse","localStorage","getItem","onVote","noStorage","push","setItem","stringify","calculatePercent","parseInt","alignPoll","customAlign","obtainColors","colors","customTheme","customStyles","theme","React","animate","animated","fadeIn","faster","styles","textAlign","align","alignItems","borderWidth","questionSeparator","alignSelf","questionSeparatorWidth","fontWeight","questionBold","color","questionColor","borderColor","result","fill","width","backgroundColor","labels","percent","Component","propTypes","PropTypes","string","isRequired","array","func","object","bool","defaultProps"],"mappings":"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"}